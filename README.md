# C++ 线程池教程 🚀

欢迎来到 C++ 线程池从零到精通的学习之旅！

## 📖 学习路径

### 第一阶段：基础线程池 (Step 1)
**目录**: `src/step1_basic/`

**学习目标**:
- 理解线程池的核心概念
- 掌握生产者-消费者模式
- 使用 `std::thread` 和 `std::mutex`
- 实现简单的任务队列

**核心知识点**:
- `std::queue` - 任务队列
- `std::mutex` - 互斥锁保护共享资源
- `std::condition_variable` - 线程间通信
- `std::function` - 存储任意可调用对象

---

### 第二阶段：支持返回值 (Step 2)
**目录**: `src/step2_future/`

**学习目标**:
- 使用 `std::future` 和 `std::promise` 获取任务结果
- 理解 `std::packaged_task` 的作用
- 实现泛型任务提交

**核心知识点**:
- `std::future` - 异步结果
- `std::packaged_task` - 打包任务
- 模板函数 - 支持任意类型的任务

---

### 第三阶段：高级特性 (Step 3)
**目录**: `src/step3_advanced/`

**学习目标**:
- 实现优雅的关闭机制
- 添加异常处理
- 支持任务优先级
- 性能监控和统计

**核心知识点**:
- RAII (资源获取即初始化)
- 异常安全
- `std::priority_queue` - 优先级队列
- 原子操作 - `std::atomic`

---

### 最终项目：生产级线程池 (Final)
**目录**: `src/final/`

**特性**:
- ✅ 完整的线程池实现
- ✅ 支持任务返回值
- ✅ 异常处理
- ✅ 优雅关闭
- ✅ 性能监控
- ✅ 线程安全
- ✅ 易于使用的 API

---

## 🛠️ 编译与运行

```bash
# 创建编译目录
mkdir build && cd build

# 配置项目
cmake ..

# 编译所有示例
make

# 运行不同阶段的示例
./step1_basic_threadpool
./step2_with_future
./step3_advanced
./final_demo
```

## 📝 学习建议

1. **按顺序学习** - 每个阶段都基于前一个阶段
2. **动手实践** - 阅读代码注释，理解每一行的作用
3. **修改代码** - 尝试修改参数，观察行为变化
4. **完成自测** - 每个阶段都有对应的测试文件（见下方）
5. **提出问题** - 遇到不理解的地方及时询问

## 🎯 自我测试系统

**如何判断是否掌握了某个阶段？**

我为每个阶段准备了完整的自测系统：

| 阶段 | 测试文件 | 内容 |
|------|---------|------|
| Step 1 | `tests/TEST_STEP1.md` | 基础概念、编码测试、实践挑战 |
| Step 2 | `tests/TEST_STEP2.md` | Future/Promise、异常处理 |
| Step 3 | `tests/TEST_STEP3.md` | 优先级、原子操作、性能统计 |

**测试包含**:
- ✅ 理论问题（带答案）
- 💻 编码测试（先自己写，再对比答案）
- 🔧 实践挑战（提升能力）
- 📊 自我评分（客观评估）

**使用方法**:
```bash
# 学完某个阶段后，打开对应的测试文件
cat tests/TEST_STEP1.md    # 第一阶段测试
cat tests/TEST_STEP2.md    # 第二阶段测试
cat tests/TEST_STEP3.md    # 第三阶段测试
```

**通关标准**: 理论全对 + 自评达标 → 可进入下一阶段

详细说明见: `tests/README.md`

## 🎯 每个阶段的重点

| 阶段 | 重点概念 | 难度 |
|------|---------|------|
| Step 1 | 基础同步原语、任务队列 | ⭐⭐ |
| Step 2 | Future/Promise、模板编程 | ⭐⭐⭐ |
| Step 3 | 高级特性、性能优化 | ⭐⭐⭐⭐ |
| Final | 完整的生产级实现 | ⭐⭐⭐⭐⭐ |

---

**准备好了吗？让我们开始吧！** 🚀
